(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[589],{809:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(2895).A)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},2138:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(2895).A)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},2915:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(2895).A)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},3786:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(2895).A)("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]])},4186:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(2895).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},4477:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>f,dynamic:()=>v});var a=t(5155),r=t(2115),l=t(4794),i=t(2915),d=t(4186),c=t(809),n=t(2895);let o=(0,n.A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);var x=t(7434),m=t(5525);let h=(0,n.A)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);var u=t(2138);let p=(0,n.A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var j=t(3786),y=t(6874),b=t.n(y),g=t(8915);let v="force-dynamic";function f(){let[e,s]=(0,r.useState)([]),[t,n]=(0,r.useState)([]),[y,v]=(0,r.useState)(""),[f,N]=(0,r.useState)("all"),[w,k]=(0,r.useState)("all"),[A,S]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{try{let e=g.j2.currentUser;if(!e)return;let t=await e.getIdToken(),a=await fetch("/api/audit",{headers:{Authorization:"Bearer ".concat(t)}});if(a.ok){let e=((await a.json()).audits||[]).map(e=>({id:e.id,repository:e.repository,branch:e.branch||"main",framework:e.framework,status:e.status,createdAt:new Date(1e3*e.createdAt.seconds),completedAt:e.completedAt?new Date(1e3*e.completedAt.seconds):void 0,duration:e.duration||0,score:e.score||0,vulnerabilities:e.vulnerabilities||[],summary:e.summary||{total:0,critical:0,high:0,medium:0,low:0,info:0}}));s(e),n(e)}}catch(e){console.error("Failed to fetch reports:",e)}})()},[]),(0,r.useEffect)(()=>{let s=e;y&&(s=s.filter(e=>e.repository.toLowerCase().includes(y.toLowerCase())||e.framework.toLowerCase().includes(y.toLowerCase()))),"all"!==f&&(s=s.filter(e=>e.status===f)),"all"!==w&&(s=s.filter(e=>"critical"===w?e.summary.critical>0:"high"===w?e.summary.high>0:"medium"===w?e.summary.medium>0:"low"!==w||e.summary.low>0)),n(s)},[e,y,f,w]);let C=e=>e>=90?"text-green-400":e>=80?"text-yellow-400":e>=70?"text-orange-400":"text-red-400";return(0,a.jsxs)("div",{className:"p-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Security Audit Reports"}),(0,a.jsx)("p",{className:"text-dark-300",children:"View and analyze your security audit results. Track vulnerabilities and get actionable fixes."})]}),(0,a.jsx)("div",{className:"card mb-8",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)(o,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-dark-400 w-5 h-5"}),(0,a.jsx)("input",{type:"text",placeholder:"Search repositories or frameworks...",value:y,onChange:e=>v(e.target.value),className:"input-field w-full pl-10"})]}),(0,a.jsxs)("select",{value:f,onChange:e=>N(e.target.value),className:"input-field min-w-[150px]",children:[(0,a.jsx)("option",{value:"all",children:"All Status"}),(0,a.jsx)("option",{value:"completed",children:"Completed"}),(0,a.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,a.jsx)("option",{value:"failed",children:"Failed"})]}),(0,a.jsxs)("select",{value:w,onChange:e=>k(e.target.value),className:"input-field min-w-[150px]",children:[(0,a.jsx)("option",{value:"all",children:"All Severities"}),(0,a.jsx)("option",{value:"critical",children:"Critical"}),(0,a.jsx)("option",{value:"high",children:"High"}),(0,a.jsx)("option",{value:"medium",children:"Medium"}),(0,a.jsx)("option",{value:"low",children:"Low"})]})]})}),0===t.length?(0,a.jsxs)("div",{className:"card text-center py-12",children:[(0,a.jsx)(x.A,{className:"w-16 h-16 text-dark-600 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-white mb-2",children:"No reports found"}),(0,a.jsx)("p",{className:"text-dark-400 mb-6",children:y||"all"!==f||"all"!==w?"Try adjusting your filters or search terms.":"Start your first security audit to see results here."}),!y&&"all"===f&&"all"===w&&(0,a.jsx)(b(),{href:"/dashboard/audit",className:"btn-primary",children:"Start Your First Audit"})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:t.map(e=>(0,a.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"card hover:scale-[1.02] transition-transform duration-200 cursor-pointer",onClick:()=>S(e),children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-1",children:e.repository}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-dark-400",children:[(0,a.jsx)("span",{children:e.framework}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:e.branch})]})]}),(0,a.jsx)("div",{className:"px-3 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"completed":return"text-green-400 bg-green-400/10 border-green-400/20";case"in-progress":return"text-yellow-400 bg-yellow-400/10 border-yellow-400/20";case"failed":return"text-red-400 bg-red-400/10 border-red-400/20";default:return"text-dark-400 bg-dark-400/10 border-dark-400/20"}})(e.status)),children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(e=>{switch(e){case"completed":return(0,a.jsx)(i.A,{className:"w-4 h-4"});case"in-progress":default:return(0,a.jsx)(d.A,{className:"w-4 h-4"});case"failed":return(0,a.jsx)(c.A,{className:"w-4 h-4"})}})(e.status),e.status.replace("-"," ")]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold ".concat(C(e.score)),children:"completed"===e.status?"".concat(e.score,"%"):"--"}),(0,a.jsx)("div",{className:"text-xs text-dark-400",children:"Security Score"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-white",children:e.duration>0?"".concat(e.duration,"m"):"--"}),(0,a.jsx)("div",{className:"text-xs text-dark-400",children:"Duration"})]})]}),"completed"===e.status&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(m.A,{className:"w-4 h-4 text-dark-400"}),(0,a.jsx)("span",{className:"text-sm text-dark-400",children:"Vulnerabilities"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[e.summary.critical>0&&(0,a.jsxs)("span",{className:"px-2 py-1 bg-red-400/10 text-red-400 text-xs rounded border border-red-400/20",children:[e.summary.critical," Critical"]}),e.summary.high>0&&(0,a.jsxs)("span",{className:"px-2 py-1 bg-orange-400/10 text-orange-400 text-xs rounded border border-orange-400/20",children:[e.summary.high," High"]}),e.summary.medium>0&&(0,a.jsxs)("span",{className:"px-2 py-1 bg-yellow-400/10 text-yellow-400 text-xs rounded border border-yellow-400/20",children:[e.summary.medium," Medium"]}),e.summary.low>0&&(0,a.jsxs)("span",{className:"px-2 py-1 bg-blue-400/10 text-blue-400 text-xs rounded border border-blue-400/20",children:[e.summary.low," Low"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-dark-800",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-dark-400",children:[(0,a.jsx)(h,{className:"w-4 h-4"}),e.createdAt.toLocaleDateString()]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-primary-400 hover:text-primary-300",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:"View Details"}),(0,a.jsx)(u.A,{className:"w-4 h-4"})]})]})]},e.id))}),A&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,a.jsxs)(l.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-dark-900 border border-dark-800 rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)("div",{className:"p-6 border-b border-dark-800",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:A.repository}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-dark-400",children:[(0,a.jsx)("span",{children:A.framework}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:A.branch}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:A.createdAt.toLocaleDateString()})]})]}),(0,a.jsx)("button",{onClick:()=>S(null),className:"text-dark-400 hover:text-white transition-colors",children:"✕"})]})}),(0,a.jsx)("div",{className:"p-6",children:"completed"===A.status?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"card text-center",children:[(0,a.jsxs)("div",{className:"text-4xl font-bold mb-2 ".concat(C(A.score)),children:[A.score,"%"]}),(0,a.jsx)("div",{className:"text-dark-400",children:"Security Score"})]}),(0,a.jsxs)("div",{className:"card text-center",children:[(0,a.jsxs)("div",{className:"text-4xl font-bold text-white mb-2",children:[A.duration,"m"]}),(0,a.jsx)("div",{className:"text-dark-400",children:"Scan Duration"})]}),(0,a.jsxs)("div",{className:"card text-center",children:[(0,a.jsx)("div",{className:"text-4xl font-bold text-white mb-2",children:A.summary.total}),(0,a.jsx)("div",{className:"text-dark-400",children:"Total Issues"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Vulnerabilities Found"}),(0,a.jsx)("div",{className:"space-y-4",children:A.vulnerabilities.map(e=>(0,a.jsxs)("div",{className:"card border-l-4 border-l-red-500",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"critical":return"text-red-400 bg-red-400/10 border-red-400/20";case"high":return"text-orange-400 bg-orange-400/10 border-orange-400/20";case"medium":return"text-yellow-400 bg-yellow-400/10 border-yellow-400/20";case"low":return"text-blue-400 bg-blue-400/10 border-blue-400/20";case"info":return"text-gray-400 bg-gray-400/10 border-gray-400/20";default:return"text-dark-400 bg-dark-400/10 border-dark-400/20"}})(e.severity)),children:e.severity.charAt(0).toUpperCase()+e.severity.slice(1)}),(0,a.jsx)("span",{className:"text-sm text-dark-400",children:e.category})]}),(0,a.jsxs)("span",{className:"text-sm text-dark-400",children:[e.file,":",e.line]})]}),(0,a.jsx)("h4",{className:"text-lg font-medium text-white mb-2",children:e.title}),(0,a.jsx)("p",{className:"text-dark-300 mb-3",children:e.description}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"text-sm font-medium text-white mb-2",children:"Recommended Fix"}),(0,a.jsx)("p",{className:"text-sm text-dark-300",children:e.fix})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"text-sm font-medium text-white mb-2",children:"AI Fix Prompt"}),(0,a.jsx)("div",{className:"bg-dark-800 rounded p-3",children:(0,a.jsx)("p",{className:"text-sm text-dark-300 font-mono",children:e.aiPrompt})})]})]})]},e.id))})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("button",{className:"btn-primary flex items-center gap-2",children:[(0,a.jsx)(p,{className:"w-4 h-4"}),"Download Report"]}),(0,a.jsxs)("button",{className:"btn-secondary flex items-center gap-2",children:[(0,a.jsx)(j.A,{className:"w-4 h-4"}),"Share Report"]})]})]}):(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(d.A,{className:"w-16 h-16 text-dark-600 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-white mb-2",children:"Audit in Progress"}),(0,a.jsx)("p",{className:"text-dark-400",children:"This security audit is currently running. You'll be notified when it's complete."})]})})]})})]})}},8915:(e,s,t)=>{"use strict";t.d(s,{db:()=>c,j2:()=>d,pD:()=>n});var a=t(3915),r=t(3004),l=t(5317);let i=0===(0,a.Dk)().length?(0,a.Wp)({apiKey:"AIzaSyDKdgXZotQ1ICFeMQB8uSKPBoF4agTs0pU",authDomain:"vibelog-lj17r.firebaseapp.com",projectId:"vibelog-lj17r",storageBucket:"vibelog-lj17r.firebasestorage.app",messagingSenderId:"503085211993",appId:"1:503085211993:web:0f0251743019bc1830ec48"}):(0,a.Dk)()[0],d=(0,r.xI)(i),c=(0,l.aU)(i),n=new r.Dt;n.addScope("repo")},9936:(e,s,t)=>{Promise.resolve().then(t.bind(t,4477))}},e=>{e.O(0,[992,416,16,734,279,441,964,358],()=>e(e.s=9936)),_N_E=e.O()}]);